<%
  # Floor selector component for current floor and total floors
  label ||= "층수"
  name ||= "floor"
  placeholder ||= "예: 5/15, 10-12/20"
  multiple ||= true
  value ||= ""
  id ||= "floor_selector_#{name}"
  
  # Common floor options for quick selection
  common_floors = [
    { current: 1, total: nil, label: "1층" },
    { current: 2, total: nil, label: "2층" },
    { current: [1, 2], total: nil, label: "저층 (1-2층)" },
    { current: [3, 7], total: nil, label: "중층 (3-7층)" },
    { current: [8, nil], total: nil, label: "고층 (8층 이상)" }
  ]
%>

<div class="floor-selector mb-6" data-controller="floor-selector">
  
  <% if label.present? %>
    <label class="block text-sm font-medium text-gray-700 mb-3">
      <%= label %>
    </label>
  <% end %>

  <!-- Manual input -->
  <div class="mb-4">
    <div class="relative">
      <input type="text" 
             name="<%= name %>" 
             id="<%= id %>"
             value="<%= value %>"
             placeholder="<%= placeholder %>"
             class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
             data-floor-selector-target="input"
             data-action="input->floor-selector#validateInput blur->floor-selector#parseInput">
      
      <!-- Help icon -->
      <div class="absolute right-3 top-1/2 transform -translate-y-1/2">
        <button type="button" 
                class="text-gray-400 hover:text-gray-600"
                data-action="click->floor-selector#toggleHelp"
                data-floor-selector-target="helpButton">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- Input validation message -->
    <div class="mt-2 text-sm" data-floor-selector-target="validation">
      <!-- Validation messages will appear here -->
    </div>
  </div>

  <!-- Quick selection buttons -->
  <div class="mb-4">
    <div class="text-xs text-gray-500 mb-2">빠른 선택</div>
    <div class="flex flex-wrap gap-2">
      <% common_floors.each_with_index do |floor_option, index| %>
        <button type="button" 
                class="px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors"
                data-action="click->floor-selector#selectQuickOption"
                data-current="<%= floor_option[:current].is_a?(Array) ? floor_option[:current].join('-') : floor_option[:current] %>"
                data-total="<%= floor_option[:total] %>">
          <%= floor_option[:label] %>
        </button>
      <% end %>
    </div>
  </div>

  <!-- Help text (initially hidden) -->
  <div class="hidden bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800" 
       data-floor-selector-target="helpText">
    <div class="font-medium mb-2">입력 형식:</div>
    <ul class="space-y-1 text-xs">
      <li><strong>5/15</strong> → 5층 (총 15층)</li>
      <li><strong>10-12/20</strong> → 10~12층 (총 20층)</li>
      <li><strong>1</strong> → 1층</li>
      <li><strong>8+</strong> → 8층 이상</li>
      <li><strong>1-3</strong> → 1~3층</li>
    </ul>
  </div>

  <!-- Parsed result display -->
  <div class="mt-4" data-floor-selector-target="result">
    <!-- Parsed floor information will appear here -->
  </div>
</div>